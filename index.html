<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EduQuest Pro - Complete Learning Platform</title>
  <style>
    :root {
      --primary: #ff6b35;
      --primary-dark: #e55a2b;
      --success: #28a745;
      --danger: #dc3545;
      --light: #fff8f0;
      --dark: #333;
      --badge: #ffd700;
      --coin: #f1c40f;
      --glass: rgba(255, 255, 255, 0.25);
    }
    body {
      font-family: 'Comic Neue', 'Segoe UI', Arial, sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #ff9a6b 0%, #ff6b35 100%);
      color: var(--dark);
      min-height: 100vh;
    }
    header {
      background: rgba(0,0,0,0.9);
      color: white;
      text-align: center;
      padding: 2rem 1rem;
    }
    h1 { margin: 0; font-size: 3.2rem; text-shadow: 0 4px 10px rgba(0,0,0,0.4); }
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    .view {
      background: var(--glass);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 2.5rem;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.3);
      display: none;
      min-height: 70vh;
    }
    #start-screen { display: block; text-align: center; }
    .grade-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1.5rem;
      max-width: 900px;
      margin: 3rem auto;
    }
    .grade-btn {
      padding: 2rem;
      background: white;
      border-radius: 20px;
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary);
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      transition: all 0.3s;
    }
    .grade-btn:hover { transform: translateY(-15px) scale(1.1); }
    .login-form {
      max-width: 400px;
      margin: 2rem auto;
      background: white;
      padding: 2rem;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    input, select {
      width: 100%;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 12px;
      border: 1px solid #ddd;
      font-size: 1.1rem;
    }
    .btn {
      padding: 1rem 2rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1.2rem;
      margin: 0.5rem;
    }
    .btn:hover { background: var(--primary-dark); }
    .back-btn { background: #6c757d; }
    .coins-display { font-size: 2rem; color: var(--coin); background: white; padding: 1rem; border-radius: 20px; text-align: center; margin: 1rem 0; box-shadow: 0 8px 20px rgba(0,0,0,0.2); }
    .badge-container { display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center; margin: 2rem 0; }
    .badge { background: var(--badge); padding: 1rem 1.5rem; border-radius: 30px; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.3); font-size: 1.2rem; }
    .subjects-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.5rem; }
    .subject-card { background: white; border-radius: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.15); cursor: pointer; transition: 0.3s; }
    .subject-card:hover { transform: translateY(-8px); }
    .subject-header { padding: 1.2rem; color: white; font-weight: bold; text-align: center; }
    .math { background: #ff6b6b; }
    .english { background: #4ecdc4; }
    .science { background: #96ceb4; }
    .sst { background: #feca57; }
    .evs { background: #a29bfe; }
    .programming { background: #00b894; }
    .chapter-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1rem; margin-top: 2rem; }
    .chapter-card { background: white; padding: 1rem; border-radius: 12px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); cursor: pointer; transition: 0.3s; }
    .chapter-card:hover { background: #ffe0d4; transform: scale(1.05); }
    .chapter-card.completed { background: #d4edda; border: 2px solid var(--success); }
    .explanation { background: #fff; padding: 1.8rem; border-radius: 12px; margin: 1.5rem 0; line-height: 1.8; }
    .practice-section { background: #f0f8ff; padding: 1.5rem; border-radius: 12px; margin-top: 2rem; }
    .smart-score { font-size: 3rem; color: var(--primary); text-align: center; font-weight: bold; }
    .stats { display: flex; justify-content: space-around; background: white; padding: 1rem; border-radius: 16px; margin: 1rem 0; }
    .question-counter { font-size: 1.5rem; text-align: center; margin: 1rem 0; }
    .ai-tutor { background: #f0f8ff; padding: 1.5rem; border-radius: 12px; margin-top: 2rem; border: 2px solid var(--primary); }
    .ai-response { margin-top: 1rem; padding: 1rem; background: white; border-radius: 8px; border-left: 4px solid var(--primary); min-height: 80px; line-height: 1.6; }
    .parent-section { background: #e8f5e8; padding: 2rem; border-radius: 20px; margin: 2rem 0; border: 2px solid var(--success); }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ddd; padding: 1rem; text-align: center; }
    th { background: #f0f4ff; }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap" rel="stylesheet">
</head>
<body>

  <!-- Start Screen -->
  <div id="start-screen">
    <header>
      <h1>EduQuest Pro</h1>
      <p>Complete Learning with All Subjects & Chapters</p>
    </header>
    <h2 style="color:white;">Choose Your Grade</h2>
    <div class="grade-buttons">
      <div class="grade-btn" onclick="showRegister()">Register / Login</div>
    </div>
    <div style="text-align:center;margin-top:2rem;">
      <button class="btn back-btn" onclick="showParentLogin()">Parent Login (Same as Student)</button>
    </div>
  </div>

  <div class="container">
    <!-- Register / Login (Same for Student & Parent) -->
    <div id="auth-view" class="view">
      <div class="login-form">
        <h2>Register or Login (Student or Parent)</h2>
        <input type="text" id="username" placeholder="Your Name">
        <input type="password" id="password" placeholder="Create/Enter Password">
        <select id="grade-select">
          <option value="">Select Grade (Students Only)</option>
          <option value="1">Grade 1</option>
          <option value="2">Grade 2</option>
          <option value="3">Grade 3</option>
          <option value="4">Grade 4</option>
          <option value="5">Grade 5</option>
          <option value="6">Grade 6</option>
          <option value="7">Grade 7</option>
          <option value="8">Grade 8</option>
          <option value="9">Grade 9</option>
          <option value="10">Grade 10</option>
          <option value="11">Grade 11</option>
          <option value="12">Grade 12</option>
        </select>
        <button class="btn" onclick="register()">Register</button>
        <button class="btn" onclick="login()">Login</button>
        <p id="auth-msg" style="color:red;"></p>
      </div>
      <button class="btn back-btn" onclick="backToStart()">Back</button>
    </div>

    <!-- Student Dashboard -->
    <div id="dashboard" class="view">
      <h2>Welcome, <span id="user-name"></span>! (Grade <span id="user-grade"></span>)</h2>
      <div class="coins-display">Coins: <span id="coin-val">0</span> ü™ô</div>
      <h3>Your Badges</h3>
      <div class="badge-container" id="badges"></div>
      <button class="btn" onclick="openSubjects()">Start Learning</button>
      <button class="btn back-btn" onclick="logout()">Logout</button>
    </div>

    <!-- Subjects -->
    <div id="subjects-view" class="view">
      <button class="btn back-btn" onclick="backToDashboard()">‚Üê Back</button>
      <h2>Choose Subject</h2>
      <div class="subjects-grid" id="subjects-grid"></div>
    </div>

    <!-- Chapters -->
    <div id="chapters-view" class="view">
      <button class="btn back-btn" onclick="backToSubjects()">‚Üê Back</button>
      <h2 id="subject-title"></h2>
      <div class="chapter-grid" id="chapter-grid"></div>
    </div>

    <!-- Chapter Practice -->
    <div id="chapter-view" class="view">
      <button class="btn back-btn" onclick="backToChapters()">‚Üê Back</button>
      <h2 id="chapter-title"></h2>
      <div class="explanation" id="chapter-explanation"></div>
      <div class="practice-section">
        <div class="smart-score">SmartScore: <span id="smart-score-val">0</span></div>
        <div class="question-counter">Question <span id="question-num">1</span> / 20 (Need 20 correct to master)</div>
        <div class="stats">
          <div>Time: <span id="timer-val">00:00</span></div>
          <div>Correct: <span id="correct-count">0</span></div>
          <button class="btn pause-btn" id="pause-btn" onclick="togglePause()">Pause</button>
        </div>
        <div id="quiz-container"></div>
        <div id="quiz-feedback"></div>
      </div>
      <div class="ai-tutor">
        <h3>Ask AI Tutor</h3>
        <textarea id="ai-question" rows="3" placeholder="Ask about this chapter..."></textarea>
        <button class="btn" onclick="askAI()">Ask</button>
        <div class="ai-response" id="ai-response">I'm ready to help! üòä</div>
      </div>
    </div>

    <!-- Parent Dashboard (Same login as student) -->
    <div id="parent-dashboard" class="view">
      <h2>Parent View for <span id="parent-name"></span></h2>
      <button class="btn back-btn" onclick="logout()">Logout</button>
      <div class="parent-section">
        <h3>Your Child's Progress</h3>
        <p>Coins: <span id="parent-coins">0</span> ü™ô</p>
        <p>Badges Earned: <span id="parent-badges-count">0</span></p>
        <p>Chapters Completed: <span id="parent-chapters">0</span></p>
        <h4>All Badges</h4>
        <div class="badge-container" id="parent-badges"></div>
      </div>
    </div>
  </div>

  <script>
    let users = JSON.parse(localStorage.getItem('eduquest_users')) || {};
    let currentUser = null;
    let currentGrade = null;
    let currentSubject = null;
    let currentChapter = null;
    let smartScore = 0;
    let correctNeeded = 20;
    let correctCount = 0;
    let questionCount = 0;
    let timeSpent = 0;
    let timerInterval = null;
    let isPaused = false;
    let isParentView = false;

    // Subjects and chapters
    const subjects = ["math", "english", "science", "sst", "evs", "programming"];
    const subjectNames = {math: "Mathematics", english: "English", science: "Science", sst: "Social Studies", evs: "EVS", programming: "Programming"};

    const chapters = {
      math: Array.from({length: 50}, (_, i) => `Chapter ${i+1}: Numbers, Addition & More`),
      english: Array.from({length: 50}, (_, i) => `Chapter ${i+1}: Reading & Grammar`),
      science: Array.from({length: 50}, (_, i) => `Chapter ${i+1}: Plants, Animals & Forces`),
      sst: Array.from({length: 50}, (_, i) => `Chapter ${i+1}: History & Geography`),
      evs: Array.from({length: 50}, (_, i) => `Chapter ${i+1}: Environment & Safety`),
      programming: Array.from({length: 50}, (_, i) => `Chapter ${i+1}: Coding Basics`)
    };

    // Larger question banks to prevent spam
    const questions = {
      math: [
        {q: "What is 4 + 5?", options: ["8","9","10","7"], ans: 1, exp: "4 + 5 = 9"},
        {q: "8 - 3 = ?", options: ["4","5","6","11"], ans: 1, exp: "8 - 3 = 5"},
        {q: "2 √ó 6 = ?", options: ["10","12","14","8"], ans: 1, exp: "2 √ó 6 = 12"},
        {q: "10 √∑ 2 = ?", options: ["4","5","6","8"], ans: 1, exp: "10 √∑ 2 = 5"},
        {q: "What is half of 10?", options: ["4","5","6","10"], ans: 1, exp: "Half of 10 is 5"},
        // Add 15+ more unique questions...
      ],
      english: [
        {q: "Cat is a ...", options: ["Verb","Noun","Adjective","Adverb"], ans: 1, exp: "Noun (naming word)"},
        {q: "Run is a ...", options: ["Noun","Verb","Adjective","Place"], ans: 1, exp: "Verb (action word)"},
        // More...
      ],
      default: [
        {q: "True or False: Learning is fun", options: ["False","True"], ans: 1, exp: "Yes! Learning is always fun!"},
        {q: "What color is the sky?", options: ["Green","Blue","Red","Yellow"], ans: 1, exp: "Usually blue during day"},
        // Many more to rotate...
      ]
    };

    function showRegister() {
      document.getElementById('start-screen').style.display = 'none';
      document.getElementById('auth-view').style.display = 'block';
    }

    function backToStart() {
      document.getElementById('auth-view').style.display = 'none';
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('parent-dashboard').style.display = 'none';
      document.getElementById('start-screen').style.display = 'block';
    }

    function showParentLogin() {
      showRegister(); // Same login form
    }

    function register() {
      const name = document.getElementById('username').value.trim();
      const pass = document.getElementById('password').value;
      const grade = document.getElementById('grade-select').value;
      if (!name || !pass) return document.getElementById('auth-msg').textContent = "Name and password required";
      if (users[name]) return document.getElementById('auth-msg').textContent = "Name already used";
      users[name] = {password: pass, grade: grade || "Parent", coins: grade ? 100 : 0, badges: grade ? ["Welcome Learner üåü"] : [], completed: {}};
      localStorage.setItem('eduquest_users', JSON.stringify(users));
      alert("Registered!");
    }

    function login() {
      const name = document.getElementById('username').value.trim();
      const pass = document.getElementById('password').value;
      if (users[name] && users[name].password === pass) {
        currentUser = name;
        isParentView = !users[name].grade || users[name].grade === "Parent";
        document.getElementById('auth-view').style.display = 'none';
        if (isParentView) {
          document.getElementById('parent-dashboard').style.display = 'block';
          document.getElementById('parent-name').textContent = name;
          document.getElementById('parent-coins').textContent = users[name].coins || 0;
          document.getElementById('parent-badges-count').textContent = (users[name].badges || []).length;
          document.getElementById('parent-chapters').textContent = Object.keys(users[name].completed || {}).length;
          document.getElementById('parent-badges').innerHTML = (users[name].badges || []).map(b => `<div class="badge">${b}</div>`).join('');
        } else {
          currentGrade = users[name].grade;
          document.getElementById('dashboard').style.display = 'block';
          document.getElementById('user-name').textContent = name;
          document.getElementById('user-grade').textContent = currentGrade;
          document.getElementById('coin-val').textContent = users[name].coins || 0;
          loadBadges();
        }
      } else {
        document.getElementById('auth-msg').textContent = "Wrong name or password";
      }
    }

    function loadBadges() {
      const container = document.getElementById('badges');
      container.innerHTML = (users[currentUser].badges || []).map(b => `<div class="badge">${b}</div>`).join('');
    }

    function openSubjects() {
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('subjects-view').style.display = 'block';
      const grid = document.getElementById('subjects-grid');
      grid.innerHTML = '';
      subjects.forEach(sub => {
        const card = document.createElement('div');
        card.className = 'subject-card';
        card.innerHTML = `<div class="subject-header ${sub}">${subjectNames[sub]}</div><div style="padding:1rem">50 Chapters</div>`;
        card.onclick = () => openChapters(sub);
        grid.appendChild(card);
      });
    }

    function openChapters(sub) {
      currentSubject = sub;
      document.getElementById('subjects-view').style.display = 'none';
      document.getElementById('chapters-view').style.display = 'block';
      document.getElementById('subject-title').textContent = subjectNames[sub];
      const grid = document.getElementById('chapter-grid');
      grid.innerHTML = '';
      chapters[sub].forEach((title, i) => {
        const completed = users[currentUser].completed[`${sub}_${i}`];
        const card = document.createElement('div');
        card.className = `chapter-card ${completed ? 'completed' : ''}`;
        card.textContent = title;
        card.onclick = () => openChapter(i, sub, title);
        grid.appendChild(card);
      });
    }

    function openChapter(index, sub, title) {
      currentChapter = index;
      document.getElementById('chapters-view').style.display = 'none';
      document.getElementById('chapter-view').style.display = 'block';
      document.getElementById('chapter-title').textContent = title;
      document.getElementById('chapter-explanation').textContent = `Lesson: ${title}\n\nPractice 20 different questions to master this chapter and earn coins!`;

      const key = `${sub}_${index}`;
      if (users[currentUser].completed[key]) {
        smartScore = 100;
        correctCount = correctNeeded;
      } else {
        smartScore = 0;
        correctCount = 0;
        questionCount = 0;
      }
      document.getElementById('smart-score-val').textContent = smartScore;
      document.getElementById('question-num').textContent = questionCount + 1;
      document.getElementById('correct-count').textContent = correctCount;
      timeSpent = 0;
      document.getElementById('timer-val').textContent = "00:00";
      if (smartScore < 100) startTimer();
      generateQuestion(sub);
    }

    function generateQuestion(sub) {
      const bank = questions[sub] || questions.default;
      const q = bank[Math.floor(Math.random() * bank.length)];
      document.getElementById('quiz-container').innerHTML = `<div class="quiz-question"><p>${q.q}</p><div class="options">${q.options.map((o, i) => `<div class="option" onclick="checkAnswer(${i}, ${q.ans}, '${q.exp}')">${o}</div>`).join('')}</div></div>`;
      document.getElementById('quiz-feedback').innerHTML = '';
    }

    function checkAnswer(selected, correct, exp) {
      if (smartScore >= 100) return;
      questionCount++;
      document.getElementById('question-num').textContent = questionCount + 1;
      const feedback = selected === correct ? "Correct! üéâ " : "Try again! ";
      document.getElementById('quiz-feedback').innerHTML = `<div style="color:${selected === correct ? 'green' : 'red'};">${feedback}${exp}</div>`;
      if (selected === correct) correctCount++;
      document.getElementById('correct-count').textContent = correctCount;
      smartScore = Math.round((correctCount / correctNeeded) * 100);
      document.getElementById('smart-score-val').textContent = smartScore;
      if (correctCount >= correctNeeded) completeChapter();
      else setTimeout(() => generateQuestion(currentSubject), 2500);
    }

    function completeChapter() {
      const key = `${currentSubject}_${currentChapter}`;
      if (!users[currentUser].completed[key]) {
        users[currentUser].completed[key] = true;
        users[currentUser].coins = (users[currentUser].coins || 0) + 50;
        users[currentUser].badges = users[currentUser].badges || [];
        users[currentUser].badges.push("Chapter Champion üèÜ");
        localStorage.setItem('eduquest_users', JSON.stringify(users));
      }
      stopTimer();
      document.getElementById('quiz-container').innerHTML = '<h3 style="text-align:center;color:green;">Chapter Mastered! +50 Coins üéâ</h3>';
    }

    function startTimer() {
      timerInterval = setInterval(() => {
        if (!isPaused) {
          timeSpent++;
          const m = String(Math.floor(timeSpent / 60)).padStart(2, '0');
          const s = String(timeSpent % 60).padStart(2, '0');
          document.getElementById('timer-val').textContent = `${m}:${s}`;
        }
      }, 1000);
    }

    function stopTimer() { clearInterval(timerInterval); }

    function togglePause() {
      isPaused = !isPaused;
      document.getElementById('pause-btn').textContent = isPaused ? "Resume" : "Pause";
    }

    function backToChapters() {
      stopTimer();
      document.getElementById('chapter-view').style.display = 'none';
      document.getElementById('chapters-view').style.display = 'block';
    }

    function backToSubjects() {
      document.getElementById('chapters-view').style.display = 'none';
      document.getElementById('subjects-view').style.display = 'block';
    }

    function backToDashboard() {
      document.getElementById('subjects-view').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
      document.getElementById('coin-val').textContent = users[currentUser].coins || 0;
    }

    function askAI() {
      const q = document.getElementById('ai-question').value.trim();
      if (!q) return;
      document.getElementById('ai-response').textContent = "Great question! üòä\nLet me explain simply:\n" + (currentSubject === "math" ? "Numbers and calculations help us every day!" : "This topic is important for understanding the world!") + "\n\nKeep practicing!";
      document.getElementById('ai-question').value = '';
    }

    function logout() {
      currentUser = null;
      isParentView = false;
      backToStart();
    }
  </script>
</body>
</html>
