<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EduQuest Pro - Fun Learning with Shop</title>
  <style>
    :root {
      --primary: #ff6b35;
      --primary-dark: #e55a2b;
      --success: #28a745;
      --danger: #dc3545;
      --light: #fff8f0;
      --dark: #333;
      --badge: #ffd700;
      --coin: #f1c40f;
      --glass: rgba(255, 255, 255, 0.25);
    }
    body {
      font-family: 'Comic Neue', 'Segoe UI', Arial, sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #ff9a6b 0%, #ff6b35 100%);
      color: var(--dark);
      min-height: 100vh;
    }
    header {
      background: rgba(0,0,0,0.9);
      color: white;
      text-align: center;
      padding: 2rem 1rem;
    }
    h1 { margin: 0; font-size: 3.2rem; text-shadow: 0 4px 10px rgba(0,0,0,0.4); }
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    .view {
      background: var(--glass);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 2.5rem;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.3);
      display: none;
      min-height: 70vh;
    }
    #start-screen { display: block; text-align: center; }
    .grade-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1.5rem;
      max-width: 900px;
      margin: 3rem auto;
    }
    .grade-btn {
      padding: 2rem;
      background: white;
      border-radius: 20px;
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary);
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      transition: all 0.3s;
    }
    .grade-btn:hover { transform: translateY(-15px) scale(1.1); }
    .login-form {
      max-width: 400px;
      margin: 2rem auto;
      background: white;
      padding: 2rem;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    input, select {
      width: 100%;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 12px;
      border: 1px solid #ddd;
      font-size: 1.1rem;
    }
    .btn {
      padding: 1rem 2rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1.2rem;
      margin: 0.5rem;
    }
    .btn:hover { background: var(--primary-dark); }
    .back-btn { background: #6c757d; }
    .shop-btn { background: #9b59b6; }
    .coins-display { font-size: 2rem; color: var(--coin); background: white; padding: 1rem; border-radius: 20px; text-align: center; margin: 1rem 0; box-shadow: 0 8px 20px rgba(0,0,0,0.2); }
    .badge-container { display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center; margin: 2rem 0; }
    .badge { background: var(--badge); padding: 1rem 1.5rem; border-radius: 30px; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.3); font-size: 1.2rem; }
    .subjects-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.5rem; }
    .subject-card { background: white; border-radius: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.15); cursor: pointer; transition: 0.3s; }
    .subject-card:hover { transform: translateY(-8px); }
    .subject-header { padding: 1.2rem; color: white; font-weight: bold; text-align: center; }
    .math { background: #ff6b6b; }
    .english { background: #4ecdc4; }
    .science { background: #96ceb4; }
    .sst { background: #feca57; }
    .evs { background: #a29bfe; }
    .programming { background: #00b894; }
    .chapter-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1rem; margin-top: 2rem; }
    .chapter-card { background: white; padding: 1rem; border-radius: 12px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); cursor: pointer; transition: 0.3s; }
    .chapter-card:hover { background: #ffe0d4; transform: scale(1.05); }
    .chapter-card.completed { background: #d4edda; border: 2px solid var(--success); }
    .explanation { background: #fff; padding: 1.8rem; border-radius: 12px; margin: 1.5rem 0; line-height: 1.8; }
    .practice-section { background: #f0f8ff; padding: 1.5rem; border-radius: 12px; margin-top: 2rem; }
    .smart-score { font-size: 3rem; color: var(--primary); text-align: center; font-weight: bold; }
    .stats { display: flex; justify-content: space-around; background: white; padding: 1rem; border-radius: 16px; margin: 1rem 0; }
    .question-counter { font-size: 1.5rem; text-align: center; margin: 1rem 0; }
    .quiz-question { margin: 1.5rem 0; padding: 1.2rem; background: white; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .options { display: flex; flex-direction: column; gap: 0.8rem; margin-top: 1rem; }
    .option { padding: 1rem; border: 2px solid #ddd; border-radius: 8px; cursor: pointer; transition: 0.3s; text-align: center; }
    .option:hover { border-color: var(--primary); }
    .option.correct { background: #d4edda; border-color: var(--success); }
    .option.incorrect { background: #f8d7da; border-color: var(--danger); }
    .feedback { margin-top: 1rem; font-weight: bold; padding: 0.8rem; border-radius: 8px; }
    .shop-items { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 2rem; }
    .shop-item { background: white; padding: 1.5rem; border-radius: 16px; text-align: center; box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
    .shop-item img { width: 100px; height: 100px; border-radius: 50%; }
    .buy-btn { background: var(--success); padding: 0.8rem 1.5rem; margin-top: 1rem; }
    .buy-btn:disabled { background: #95a5a6; cursor: not-allowed; }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap" rel="stylesheet">
</head>
<body>

  <!-- Start Screen -->
  <div id="start-screen">
    <header>
      <h1>EduQuest Pro</h1>
      <p>Fun Learning Adventure with Coins & Shop!</p>
    </header>
    <h2 style="color:white;">Choose Your Grade</h2>
    <div class="grade-buttons">
      <div class="grade-btn" onclick="showAuth('student')">Student Login/Register</div>
      <div class="grade-btn" onclick="showAuth('parent')">Parent Login/Register</div>
    </div>
  </div>

  <div class="container">
    <!-- Auth View -->
    <div id="auth-view" class="view">
      <div class="login-form">
        <h2 id="auth-title">Login / Register</h2>
        <input type="text" id="username" placeholder="Your Name">
        <input type="password" id="password" placeholder="Create/Enter Password">
        <select id="grade-select" style="display:none;">
          <option value="">Select Grade</option>
          <option value="1">Grade 1</option>
          <option value="2">Grade 2</option>
          <option value="3">Grade 3</option>
          <option value="4">Grade 4</option>
          <option value="5">Grade 5</option>
          <option value="6">Grade 6</option>
          <option value="7">Grade 7</option>
          <option value="8">Grade 8</option>
          <option value="9">Grade 9</option>
          <option value="10">Grade 10</option>
          <option value="11">Grade 11</option>
          <option value="12">Grade 12</option>
        </select>
        <button class="btn" onclick="register()">Register</button>
        <button class="btn" onclick="login()">Login</button>
        <p id="auth-msg" style="color:red;"></p>
      </div>
      <button class="btn back-btn" onclick="backToStart()">Back</button>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="view">
      <h2>Welcome, <span id="user-name"></span>!</h2>
      <div class="coins-display">Coins: <span id="coin-val">0</span> ü™ô</div>
      <h3>Your Badges</h3>
      <div class="badge-container" id="badges"></div>
      <button class="btn shop-btn" onclick="openShop()">üõí Open Coin Shop</button>
      <button class="btn" onclick="openSubjects()">Start Learning</button>
      <button class="btn back-btn" onclick="logout()">Logout</button>
    </div>

    <!-- Shop -->
    <div id="shop-view" class="view">
      <button class="btn back-btn" onclick="backToDashboard()">‚Üê Back</button>
      <h2>üõí Coin Shop</h2>
      <div class="coins-display">You have <span id="shop-coins">0</span> ü™ô</div>
      <div class="shop-items">
        <div class="shop-item">
          <img src="https://img.icons8.com/emoji/100/rocket-emoji.png" alt="Rocket">
          <h3>Super Rocket</h3>
          <p>Speed Booster Avatar</p>
          <button class="btn buy-btn" onclick="buyItem('rocket', 200)">Buy - 200 ü™ô</button>
        </div>
        <div class="shop-item">
          <img src="https://img.icons8.com/emoji/100/crown.png" alt="Crown">
          <h3>Golden Crown</h3>
          <p>Royal Look</p>
          <button class="btn buy-btn" onclick="buyItem('crown', 300)">Buy - 300 ü™ô</button>
        </div>
        <div class="shop-item">
          <img src="https://img.icons8.com/emoji/100/unicorn.png" alt="Unicorn">
          <h3>Magical Unicorn</h3>
          <p>Rainbow Power</p>
          <button class="btn buy-btn" onclick="buyItem('unicorn', 500)">Buy - 500 ü™ô</button>
        </div>
        <div class="shop-item">
          <img src="https://img.icons8.com/emoji/100/trophy-emoji.png" alt="Trophy">
          <h3>Champion Trophy</h3>
          <p>Master Badge</p>
          <button class="btn buy-btn" onclick="buyItem('trophy', 400)">Buy - 400 ü™ô</button>
        </div>
      </div>
    </div>

    <!-- Subjects -->
    <div id="subjects-view" class="view">
      <button class="btn back-btn" onclick="backToDashboard()">‚Üê Back</button>
      <h2>Choose Subject</h2>
      <div class="subjects-grid" id="subjects-grid"></div>
    </div>

    <!-- Chapters (minimum 15 per subject) -->
    <div id="chapters-view" class="view">
      <button class="btn back-btn" onclick="backToSubjects()">‚Üê Back</button>
      <h2 id="subject-title"></h2>
      <div class="chapter-grid" id="chapter-grid"></div>
    </div>

    <!-- Chapter Practice -->
    <div id="chapter-view" class="view">
      <button class="btn back-btn" onclick="backToChapters()">‚Üê Back</button>
      <h2 id="chapter-title"></h2>
      <div class="explanation" id="chapter-explanation"></div>
      <div class="practice-section">
        <div class="smart-score">SmartScore: <span id="smart-score-val">0</span></div>
        <div class="question-counter">Question <span id="question-num">1</span></div>
        <div class="stats">
          <div>Time: <span id="timer-val">00:00</span></div>
          <div>Correct: <span id="correct-count">0</span>/20</div>
          <button class="btn pause-btn" id="pause-btn" onclick="togglePause()">Pause</button>
        </div>
        <div id="quiz-container"></div>
        <div id="quiz-feedback"></div>
      </div>
    </div>
  </div>

  <script>
    let users = JSON.parse(localStorage.getItem('eduquest_users')) || {};
    let currentUser = null;
    let currentGrade = null;
    let currentSubject = null;
    let currentChapter = null;
    let smartScore = 0;
    let correctNeeded = 20;
    let correctCount = 0;
    let timeSpent = 0;
    let timerInterval = null;
    let isPaused = false;
    let authType = '';

    const subjects = ["math", "english", "science", "sst", "evs", "programming"];
    const subjectNames = {math: "Mathematics", english: "English", science: "Science", sst: "Social Studies", evs: "EVS", programming: "Programming"};

    // 15+ different chapters per subject (expandable)
    const chapters = {
      math: ["Counting 1-20", "Addition Basics", "Subtraction", "Shapes", "Patterns", "Time", "Money", "Measurement", "Fractions Intro", "Place Value", "Skip Counting", "Simple Multiplication", "Division Intro", "Data Graphs", "Geometry Fun"],
      english: ["Alphabet Mastery", "Rhyming Words", "Sight Words", "Simple Sentences", "Nouns", "Verbs", "Adjectives", "Story Reading", "Writing Practice", "Punctuation", "Synonyms", "Antonyms", "Comprehension", "Creative Writing", "Grammar Rules"],
      science: ["Living Things", "Plants", "Animals", "Human Body", "Weather", "Seasons", "Materials", "Force & Motion", "Light & Sound", "Magnets", "Electricity Basics", "Water Cycle", "Solar System", "Earth", "Environment"],
      sst: ["My Family", "My School", "Neighborhood", "Community Helpers", "Festivals", "Transport", "Safety Rules", "Our Country", "States", "Historical Places", "Freedom Fighters", "Government", "Maps", "Continents", "Resources"],
      evs: ["My Home", "Food We Eat", "Clothes", "Water", "Air", "Good Habits", "Plants Around Us", "Animals Around Us", "Safety", "Recycling", "Pollution", "Conservation", "Natural Resources", "Healthy Living", "Community"],
      programming: ["What is Coding?", "Sequences", "Loops Intro", "Simple Commands", "Patterns in Code", "Debugging", "Algorithms", "Conditionals", "Variables", "Functions", "Events", "Games Intro", "Animation", "Projects", "Advanced Logic"]
    };

    const questions = {
      math: [
        {q: "What is 5 + 4?", options: ["8","9","10"], ans: 1, exp: "5 + 4 = 9"},
        {q: "7 - 2 = ?", options: ["4","5","6"], ans: 1, exp: "7 - 2 = 5"},
        {q: "How many sides in a square?", options: ["3","4","5"], ans: 1, exp: "Square has 4 sides"},
        // Add more unique questions...
      ],
      // Similar for other subjects
      default: [{q: "Good job learning!", options: ["Yes","Great"], ans: 0, exp: "Keep going!"}]
    };

    const shopItems = {
      rocket: {name: "üöÄ Super Rocket", price: 200},
      crown: {name: "üëë Golden Crown", price: 300},
      unicorn: {name: "ü¶Ñ Magical Unicorn", price: 500},
      trophy: {name: "üèÜ Champion Trophy", price: 400}
    };

    function showAuth(type) {
      authType = type;
      document.getElementById('start-screen').style.display = 'none';
      document.getElementById('auth-view').style.display = 'block';
      document.getElementById('auth-title').textContent = type === 'parent' ? "Parent Login/Register" : "Student Login/Register";
      document.getElementById('grade-select').style.display = type === 'student' ? 'block' : 'none';
    }

    function backToStart() {
      document.getElementById('auth-view').style.display = 'none';
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('shop-view').style.display = 'none';
      document.getElementById('subjects-view').style.display = 'none';
      document.getElementById('chapters-view').style.display = 'none';
      document.getElementById('chapter-view').style.display = 'none';
      document.getElementById('start-screen').style.display = 'block';
    }

    function register() {
      const name = document.getElementById('username').value.trim();
      const pass = document.getElementById('password').value;
      const grade = authType === 'student' ? document.getElementById('grade-select').value : "Parent";
      if (!name || !pass || (authType === 'student' && !grade)) return alert("Fill all fields");
      if (users[name]) return alert("Name already used");
      users[name] = {password: pass, grade: grade, coins: authType === 'student' ? 100 : 0, badges: authType === 'student' ? ["Welcome Hero üåü"] : [], inventory: [], completed: {}};
      localStorage.setItem('eduquest_users', JSON.stringify(users));
      alert("Registered! Now login");
    }

    function login() {
      const name = document.getElementById('username').value.trim();
      const pass = document.getElementById('password').value;
      if (users[name] && users[name].password === pass) {
        currentUser = name;
        document.getElementById('auth-view').style.display = 'none';
        document.getElementById('dashboard').style.display = 'block';
        document.getElementById('user-name').textContent = name;
        document.getElementById('coin-val').textContent = users[name].coins || 0;
        loadBadges();
      } else {
        alert("Wrong name or password");
      }
    }

    function loadBadges() {
      const container = document.getElementById('badges');
      container.innerHTML = '';
      (users[currentUser].badges || []).forEach(b => {
        const div = document.createElement('div');
        div.className = 'badge';
        div.textContent = b;
        container.appendChild(div);
      });
      (users[currentUser].inventory || []).forEach(item => {
        const div = document.createElement('div');
        div.className = 'badge';
        div.textContent = shopItems[item].name;
        container.appendChild(div);
      });
    }

    function openShop() {
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('shop-view').style.display = 'block';
      document.getElementById('shop-coins').textContent = users[currentUser].coins || 0;
    }

    function buyItem(item, price) {
      if ((users[currentUser].coins || 0) >= price) {
        users[currentUser].coins -= price;
        if (!users[currentUser].inventory.includes(item)) {
          users[currentUser].inventory.push(item);
          users[currentUser].badges.push(shopItems[item].name);
        }
        localStorage.setItem('eduquest_users', JSON.stringify(users));
        alert("Bought " + shopItems[item].name + "!");
        document.getElementById('coin-val').textContent = users[currentUser].coins;
        document.getElementById('shop-coins').textContent = users[currentUser].coins;
        loadBadges();
      } else {
        alert("Not enough coins!");
      }
    }

    function backToDashboard() {
      document.getElementById('shop-view').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
      document.getElementById('coin-val').textContent = users[currentUser].coins || 0;
    }

    function openSubjects() {
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('subjects-view').style.display = 'block';
      const grid = document.getElementById('subjects-grid');
      grid.innerHTML = '';
      subjects.forEach(sub => {
        const card = document.createElement('div');
        card.className = 'subject-card';
        card.innerHTML = `<div class="subject-header ${sub}">${subjectNames[sub]}</div><div style="padding:1rem">Chapters Available</div>`;
        card.onclick = () => openChapters(sub);
        grid.appendChild(card);
      });
    }

    function openChapters(sub) {
      currentSubject = sub;
      document.getElementById('subjects-view').style.display = 'none';
      document.getElementById('chapters-view').style.display = 'block';
      document.getElementById('subject-title').textContent = subjectNames[sub];
      const grid = document.getElementById('chapter-grid');
      grid.innerHTML = '';
      chapters[sub].forEach((title, i) => {
        const completed = users[currentUser].completed[`${sub}_${i}`];
        const card = document.createElement('div');
        card.className = `chapter-card ${completed ? 'completed' : ''}`;
        card.textContent = title;
        card.onclick = () => openChapter(i, sub, title);
        grid.appendChild(card);
      });
    }

    function openChapter(index, sub, title) {
      currentChapter = index;
      document.getElementById('chapters-view').style.display = 'none';
      document.getElementById('chapter-view').style.display = 'block';
      document.getElementById('chapter-title').textContent = title;
      document.getElementById('chapter-explanation').textContent = `Chapter: ${title}\n\nLearn and practice to earn coins!`;

      const key = `${sub}_${index}`;
      correctCount = users[currentUser].completed[key] ? correctNeeded : 0;
      smartScore = correctCount * 5;
      document.getElementById('smart-score-val').textContent = smartScore;
      document.getElementById('correct-count').textContent = correctCount;
      document.getElementById('question-num').textContent = "Next";
      timeSpent = 0;
      document.getElementById('timer-val').textContent = "00:00";
      if (smartScore < 100) startTimer();
      generateQuestion(sub);
    }

    function generateQuestion(sub) {
      const bank = questions[sub] || questions.default;
      const q = bank[Math.floor(Math.random() * bank.length)];
      document.getElementById('quiz-container').innerHTML = `<div class="quiz-question"><p>${q.q}</p><div class="options">${q.options.map((o, i) => `<div class="option" onclick="checkAnswer(${i}, ${q.ans}, '${q.exp}')">${o}</div>`).join('')}</div></div>`;
      document.getElementById('quiz-feedback').innerHTML = '';
    }

    function checkAnswer(selected, correct, exp) {
      if (smartScore >= 100) return;
      const feedback = selected === correct ? "Correct! üéâ" : "Wrong! Try again";
      document.getElementById('quiz-feedback').innerHTML = `<div style="color:${selected === correct ? 'green' : 'red'};">${feedback} - ${exp}</div>`;
      if (selected === correct) {
        correctCount++;
        document.getElementById('correct-count').textContent = correctCount;
        smartScore = correctCount * 5;
        document.getElementById('smart-score-val').textContent = smartScore;
        if (correctCount >= correctNeeded) completeChapter();
      }
      setTimeout(() => generateQuestion(currentSubject), 800); // Fast transition
    }

    function completeChapter() {
      const key = `${currentSubject}_${currentChapter}`;
      if (!users[currentUser].completed[key]) {
        users[currentUser].completed[key] = true;
        users[currentUser].coins = (users[currentUser].coins || 0) + 50;
        users[currentUser].badges.push("Chapter Master üèÜ");
        localStorage.setItem('eduquest_users', JSON.stringify(users));
      }
      stopTimer();
      document.getElementById('quiz-container').innerHTML = '<h3 style="text-align:center;color:green;">Chapter Complete! +50 Coins üéâ</h3>';
    }

    function startTimer() {
      timerInterval = setInterval(() => {
        if (!isPaused) {
          timeSpent++;
          const m = String(Math.floor(timeSpent / 60)).padStart(2, '0');
          const s = String(timeSpent % 60).padStart(2, '0');
          document.getElementById('timer-val').textContent = `${m}:${s}`;
        }
      }, 1000);
    }

    function stopTimer() { clearInterval(timerInterval); }

    function togglePause() {
      isPaused = !isPaused;
      document.getElementById('pause-btn').textContent = isPaused ? "Resume" : "Pause";
    }

    function backToChapters() {
      stopTimer();
      document.getElementById('chapter-view').style.display = 'none';
      document.getElementById('chapters-view').style.display = 'block';
    }

    function backToSubjects() {
      document.getElementById('chapters-view').style.display = 'none';
      document.getElementById('subjects-view').style.display = 'block';
    }

    function logout() {
      currentUser = null;
      backToStart();
    }
  </script>
</body>
</html>
